//! The `wana_kana::ConvertJapanese` trait is implemented for `&str`, which allows
//! conversion between kana and romaji.
//!
//! # Examples
//!
//! ```
//! use wana_kana::ConvertJapanese;
//! // to kana
//! assert_eq!("o".to_kana(), "„Åä");
//! assert_eq!("ona".to_kana(), "„Åä„Å™");
//! assert_eq!("onaji".to_kana(), "„Åä„Å™„Åò");
//! assert_eq!("onaji BUTTSUUJI".to_kana(), "„Åä„Å™„Åò „Éñ„ÉÉ„ÉÑ„Ç¶„Ç∏");
//! assert_eq!("ONAJI buttsuuji".to_kana(), "„Ç™„Éä„Ç∏ „Å∂„Å£„Å§„ÅÜ„Åò");
//! assert_eq!("Â∫ßÁ¶Ö‚Äòzazen‚Äô„Çπ„Çø„Ç§„É´".to_kana(), "Â∫ßÁ¶Ö„Äå„Åñ„Åú„Çì„Äç„Çπ„Çø„Ç§„É´");
//! // to hiragana
//! assert_eq!("toukyou,„Ç™„Ç™„Çµ„Ç´".to_hiragana(), "„Å®„ÅÜ„Åç„Çá„ÅÜ„ÄÅ„Åä„Åä„Åï„Åã");
//! // to katakana
//! assert_eq!("toukyou,„Åä„Åä„Åï„Åã".to_katakana(), "„Éà„Ç¶„Ç≠„Éß„Ç¶„ÄÅ„Ç™„Ç™„Çµ„Ç´");
//! // to romaji
//! assert_eq!("„Å≤„Çâ„Åå„Å™„ÄÄ„Ç´„Çø„Ç´„Éä".to_romaji(), "hiragana katakana");
//! ```
#[cfg(feature = "enable_regex")]
use regex::Regex;

use crate::Options;

/// The `wana_kana::ConvertJapanese` trait is implemented for `&str`, which allows
/// conversion between kana and romaji.
///
/// # Examples
///
/// ```
/// use wana_kana::ConvertJapanese;
/// // to kana
/// assert_eq!("o".to_kana(), "„Åä");
/// assert_eq!("ona".to_kana(), "„Åä„Å™");
/// assert_eq!("onaji".to_kana(), "„Åä„Å™„Åò");
/// assert_eq!("onaji BUTTSUUJI".to_kana(), "„Åä„Å™„Åò „Éñ„ÉÉ„ÉÑ„Ç¶„Ç∏");
/// assert_eq!("ONAJI buttsuuji".to_kana(), "„Ç™„Éä„Ç∏ „Å∂„Å£„Å§„ÅÜ„Åò");
/// assert_eq!("Â∫ßÁ¶Ö‚Äòzazen‚Äô„Çπ„Çø„Ç§„É´".to_kana(), "Â∫ßÁ¶Ö„Äå„Åñ„Åú„Çì„Äç„Çπ„Çø„Ç§„É´");
/// // to hiragana
/// assert_eq!("toukyou,„Ç™„Ç™„Çµ„Ç´".to_hiragana(), "„Å®„ÅÜ„Åç„Çá„ÅÜ„ÄÅ„Åä„Åä„Åï„Åã");
/// // to katakana
/// assert_eq!("toukyou,„Åä„Åä„Åï„Åã".to_katakana(), "„Éà„Ç¶„Ç≠„Éß„Ç¶„ÄÅ„Ç™„Ç™„Çµ„Ç´");
/// // to romaji
/// assert_eq!("„Å≤„Çâ„Åå„Å™„ÄÄ„Ç´„Çø„Ç´„Éä".to_romaji(), "hiragana katakana");
/// ```
pub trait ConvertJapanese {
    /// Convert [Romaji](https://en.wikipedia.org/wiki/Romaji) to [Kana](https://en.wikipedia.org/wiki/Kana), lowercase text will result in [Hiragana](https://en.wikipedia.org/wiki/Hiragana) and uppercase text will result in [Katakana](https://en.wikipedia.org/wiki/Katakana).
    /// # Examples
    /// ```
    /// use wana_kana::ConvertJapanese;
    /// assert_eq!("o".to_kana(), "„Åä");
    /// assert_eq!("ona".to_kana(), "„Åä„Å™");
    /// assert_eq!("onaji".to_kana(), "„Åä„Å™„Åò");
    /// assert_eq!("onaji BUTTSUUJI".to_kana(), "„Åä„Å™„Åò „Éñ„ÉÉ„ÉÑ„Ç¶„Ç∏");
    /// assert_eq!("ONAJI buttsuuji".to_kana(), "„Ç™„Éä„Ç∏ „Å∂„Å£„Å§„ÅÜ„Åò");
    /// assert_eq!("Â∫ßÁ¶Ö‚Äòzazen‚Äô„Çπ„Çø„Ç§„É´".to_kana(), "Â∫ßÁ¶Ö„Äå„Åñ„Åú„Çì„Äç„Çπ„Çø„Ç§„É´");
    /// assert_eq!("!?./,~-‚Äò‚Äô‚Äú‚Äù[](){}".to_kana(), "ÔºÅÔºü„ÄÇ„Éª„ÄÅ„Äú„Éº„Äå„Äç„Äé„ÄèÔºªÔºΩÔºàÔºâÔΩõÔΩù");
    /// ```
    fn to_kana(self) -> String;

    /// Convert [Romaji](https://en.wikipedia.org/wiki/Romaji) to [Kana](https://en.wikipedia.org/wiki/Kana), lowercase text will result in [Hiragana](https://en.wikipedia.org/wiki/Hiragana) and uppercase text will result in [Katakana](https://en.wikipedia.org/wiki/Katakana).
    /// # Examples
    /// ```
    /// use wana_kana::ConvertJapanese;
    /// use wana_kana::Options;
    /// assert_eq!("batsuge-mu".to_kana_with_opt(Options {use_obsolete_kana: true, ..Default::default() } ), "„Å∞„Å§„Åí„Éº„ÇÄ");
    /// assert_eq!("we".to_kana_with_opt(Options {use_obsolete_kana: true, ..Default::default() } ), "„Çë");
    /// ```
    fn to_kana_with_opt(self, options: Options) -> String;

    /// Convert input to [Hiragana](https://en.wikipedia.org/wiki/Hiragana)
    /// # Examples
    /// ```
    /// use wana_kana::ConvertJapanese;
    /// assert_eq!("toukyou,„Ç™„Ç™„Çµ„Ç´".to_hiragana(), "„Å®„ÅÜ„Åç„Çá„ÅÜ„ÄÅ„Åä„Åä„Åï„Åã");
    /// assert_eq!("wi".to_hiragana(), "„ÅÜ„ÅÉ");
    /// ```
    fn to_hiragana(self) -> String;

    /// Convert input to [Hiragana](https://en.wikipedia.org/wiki/Hiragana)
    /// # Examples
    /// ```
    /// use wana_kana::ConvertJapanese;
    /// use wana_kana::Options;
    /// assert_eq!("only „Åã„Å™".to_hiragana_with_opt(Options {pass_romaji: true, ..Default::default() } ), "only „Åã„Å™");
    /// assert_eq!("wi".to_hiragana_with_opt(Options {use_obsolete_kana: true, ..Default::default() } ), "„Çê");
    /// ```
    fn to_hiragana_with_opt(self, options: Options) -> String;

    /// Convert input to [Katakana](https://en.wikipedia.org/wiki/Katakana)
    fn to_katakana(self) -> String;

    /// Convert input to [Katakana](https://en.wikipedia.org/wiki/Katakana)
    fn to_katakana_with_opt(self, options: Options) -> String;

    /// Convert kana to romaji
    /// # Examples
    /// ```
    /// use wana_kana::ConvertJapanese;
    /// assert_eq!("„Å≤„Çâ„Åå„Å™„ÄÄ„Ç´„Çø„Ç´„Éä".to_romaji(), "hiragana katakana");
    /// ```
    fn to_romaji(self) -> String;

    /// Convert kana to romaji with Options.
    /// # Examples
    /// ```
    /// use wana_kana::ConvertJapanese;
    /// use wana_kana::Options;
    /// assert_eq!("„Å≤„Çâ„Åå„Å™„ÄÄ„Ç´„Çø„Ç´„Éä".to_romaji_with_opt(Options {upcase_katakana: true, ..Default::default() } ), "hiragana KATAKANA");
    /// ```

    fn to_romaji_with_opt(self, options: Options) -> String;
}

impl ConvertJapanese for &str {
    #[inline]
    fn to_kana(self) -> String {
        crate::to_kana::to_kana(self)
    }

    #[inline]
    fn to_kana_with_opt(self, options: Options) -> String {
        crate::to_kana::to_kana_with_opt(self, options)
    }

    #[inline]
    fn to_hiragana(self) -> String {
        crate::to_hiragana::to_hiragana(self)
    }

    #[inline]
    fn to_hiragana_with_opt(self, options: Options) -> String {
        crate::to_hiragana::to_hiragana_with_opt(self, options)
    }

    #[inline]
    fn to_katakana(self) -> String {
        crate::to_katakana::to_katakana(self)
    }

    #[inline]
    fn to_katakana_with_opt(self, options: Options) -> String {
        crate::to_katakana::to_katakana_with_opt(self, options)
    }

    #[inline]
    fn to_romaji(self) -> String {
        crate::to_romaji::to_romaji(self)
    }

    #[inline]
    fn to_romaji_with_opt(self, options: Options) -> String {
        crate::to_romaji::to_romaji_with_opt(self, options)
    }
}

/// The `wana_kana::IsJapaneseStr` trait is implemented for `&str`, which allows easy
/// checking of whether a string is fully composed of hiragana, katakana, kana,
/// kanji, Japanese, or mixed.
pub trait IsJapaneseStr {
    /// Test if all chars of `input` are [Hiragana](https://en.wikipedia.org/wiki/Hiragana)
    ///
    /// # Examples
    /// ```
    /// use wana_kana::IsJapaneseStr;
    /// assert_eq!("„Åí„Éº„ÇÄ".is_hiragana(), true);
    /// assert_eq!("A".is_hiragana(), false);
    /// assert_eq!("„ÅÇ„Ç¢".is_hiragana(), false);
    /// ```
    fn is_hiragana(&self) -> bool;
    /// Test if all chars of `input` are [Katakana](https://en.wikipedia.org/wiki/Katakana)
    ///
    /// # Examples
    /// ```
    /// use wana_kana::IsJapaneseStr;
    /// assert_eq!("„Ç≤„Éº„É†".is_katakana(), true);
    /// assert_eq!("„ÅÇ".is_katakana(), false);
    /// assert_eq!("A".is_katakana(), false);
    /// assert_eq!("„ÅÇ„Ç¢".is_katakana(), false);
    /// ```
    fn is_katakana(&self) -> bool;
    /// Test if all chars of `input` are [Kana](https://en.wikipedia.org/wiki/Kana) ([Katakana](https://en.wikipedia.org/wiki/Katakana) and/or [Hiragana](https://en.wikipedia.org/wiki/Hiragana))
    ///
    /// # Examples
    /// ```
    /// use wana_kana::IsJapaneseStr;
    /// assert_eq!("„ÅÇ".is_kana(), true);
    /// assert_eq!("„Ç¢".is_kana(), true);
    /// assert_eq!("„ÅÇ„Éº„Ç¢".is_kana(), true);
    /// assert_eq!("A".is_kana(), false);
    /// assert_eq!("„ÅÇA„Ç¢".is_kana(), false);
    /// ```
    fn is_kana(&self) -> bool;
    /// Test if every char in `input` is [Romaji](https://en.wikipedia.org/wiki/Romaji) (allowing [Hepburn romanisation](https://en.wikipedia.org/wiki/Hepburn_romanization))
    ///
    /// # Examples
    /// ```
    /// use wana_kana::IsJapaneseStr;
    /// assert_eq!("A".is_romaji(), true);
    /// assert_eq!("xYz".is_romaji(), true);
    /// assert_eq!("T≈çky≈ç and ≈åsaka".is_romaji(), true);
    /// assert_eq!("„ÅÇ„Ç¢A".is_romaji(), false);
    /// assert_eq!("„ÅäÈ°ò„ÅÑ".is_romaji(), false);
    /// assert_eq!("ÁÜüÊàê".is_romaji(), false);
    /// assert_eq!("a*b&c-d".is_romaji(), true);
    /// assert_eq!("0123456789".is_romaji(), true);
    /// assert_eq!("aÔºÅb&c„Éºd".is_romaji(), false);
    /// assert_eq!("ÔΩàÔΩÖÔΩåÔΩåÔΩè".is_romaji(), false);
    /// ```
    fn is_romaji(&self) -> bool;

    #[cfg_attr(docsrs, doc(cfg(feature = "enable_regex")))]
    #[cfg(feature = "enable_regex")]
    /// Test if every char in `input` is [Romaji](https://en.wikipedia.org/wiki/Romaji) (allowing [Hepburn romanisation](https://en.wikipedia.org/wiki/Hepburn_romanization)
    /// or matches the provided regex
    /// # Examples
    /// ```
    /// use wana_kana::IsJapaneseStr;
    /// use regex::Regex;
    /// assert_eq!(
    ///     "aÔºÅb&c„Éºd".is_romaji_with_whitelist(Some(&Regex::new(r"[ÔºÅ„Éº]").unwrap())),
    ///     true
    /// );
    /// ```
    fn is_romaji_with_whitelist(&self, allowed: Option<&Regex>) -> bool;

    /// Test if all chars of `input` are [Kanji](https://en.wikipedia.org/wiki/Kanji) ([Japanese CJK ideographs](https://en.wikipedia.org/wiki/CJK_Unified_Ideographs))
    ///
    /// # Examples
    /// ```
    /// use wana_kana::IsJapaneseStr;
    /// assert_eq!("ÂàÄ".is_kanji(), true);
    /// assert_eq!("ÂàáËÖπ".is_kanji(), true);
    /// assert_eq!("Âã¢„ÅÑ".is_kanji(), false);
    /// assert_eq!("„ÅÇA„Ç¢".is_kanji(), false);
    /// assert_eq!("üê∏".is_kanji(), false);
    /// ```
    fn is_kanji(&self) -> bool;

    /// Test if any chars of `input` are [Kanji](https://en.wikipedia.org/wiki/Kanji) ([Japanese CJK ideographs](https://en.wikipedia.org/wiki/CJK_Unified_Ideographs))
    ///
    /// # Examples
    /// ```
    /// use wana_kana::IsJapaneseStr;
    /// assert_eq!("Âã¢„ÅÑ".contains_kanji(), true);
    /// assert_eq!("hello".contains_kanji(), false);
    /// ```
    fn contains_kanji(&self) -> bool;

    /// Test if `input` only includes [Kanji](https://en.wikipedia.org/wiki/Kanji), [Kana](https://en.wikipedia.org/wiki/Kana), zenkaku punctuation, japanese symbols and japanese numbers.
    ///
    /// # Examples
    /// ```
    /// use wana_kana::IsJapaneseStr;
    /// assert_eq!("Ê≥£„ÅçËô´".is_japanese(), true);
    /// assert_eq!("„ÅÇ„Ç¢".is_japanese(), true);
    /// assert_eq!("ÔºíÊúà".is_japanese(), true); // Zenkaku numbers allowed
    /// assert_eq!("2Êúà".is_japanese(), false); // Normal numbers not allowed
    /// assert_eq!("Ê≥£„ÅçËô´„ÄÇÔºÅ„ÄúÔºÑ".is_japanese(), true); // Zenkaku/JA punctuation
    /// assert_eq!("Ê≥£„ÅçËô´.!~$".is_japanese(), false); // Latin punctuation fails
    /// assert_eq!("A".is_japanese(), false);
    /// ```
    fn is_japanese(&self) -> bool;

    #[cfg_attr(docsrs, doc(cfg(feature = "enable_regex")))]
    #[cfg(feature = "enable_regex")]
    /// Checks if all chars are in the japanese unicode ranges or match the provided regex
    /// # Examples
    /// ```
    /// use wana_kana::IsJapaneseStr;
    /// use regex::Regex;
    /// assert_eq!(
    ///     "‚â™ÂÅΩÊã¨Âºß‚â´".is_japanese_with_whitelist(Some(&Regex::new(r"[‚â™‚â´]").unwrap())),
    ///     true
    /// );
    /// ```
    fn is_japanese_with_whitelist(self, allowed: Option<&Regex>) -> bool;

    /// Test if `input` contains a mix of [Romaji](https://en.wikipedia.org/wiki/Romaji) and [Kana](https://en.wikipedia.org/wiki/Kana),
    /// or [Kanji](https://en.wikipedia.org/wiki/Kanji)
    ///
    /// # Examples
    /// ```
    /// use wana_kana::IsJapaneseStr;
    /// assert_eq!("A„Ç¢".is_mixed(), true);
    /// assert_eq!("A„ÅÇ".is_mixed(), true);
    /// assert_eq!("A„ÅÇ„Ç¢".is_mixed(), true);
    /// assert_eq!("Ôºí„ÅÇ„Ç¢".is_mixed(), false);
    /// assert_eq!("„ÅäËÖπA".is_mixed(), true);
    /// ```
    fn is_mixed(&self) -> bool;

    /// Test if `input` contains a mix of [Romaji](https://en.wikipedia.org/wiki/Romaji) and [Kana](https://en.wikipedia.org/wiki/Kana),
    /// or [Kanji](https://en.wikipedia.org/wiki/Kanji)
    ///
    /// # Examples
    /// ```
    /// use wana_kana::IsJapaneseStr;
    /// assert_eq!("Ab„ÅÇ„Ç¢".is_mixed_pass_kanji(true), true);
    /// assert_eq!("„ÅäËÖπA".is_mixed_pass_kanji(true), true);
    /// assert_eq!("„ÅäËÖπA".is_mixed_pass_kanji(false), false);
    /// assert_eq!("ab".is_mixed_pass_kanji(true), false);
    /// assert_eq!("„ÅÇ„Ç¢".is_mixed_pass_kanji(true), false);
    /// ```
    fn is_mixed_pass_kanji(&self, pass_kanji: bool) -> bool;
}

impl IsJapaneseStr for &str {
    #[inline]
    fn is_hiragana(&self) -> bool {
        crate::is_hiragana::is_hiragana(self)
    }

    #[inline]
    fn is_katakana(&self) -> bool {
        crate::is_katakana::is_katakana(self)
    }

    #[inline]
    fn is_kana(&self) -> bool {
        crate::is_kana::is_kana(self)
    }

    #[inline]
    fn is_kanji(&self) -> bool {
        crate::is_kanji::is_kanji(self)
    }

    #[inline]
    fn contains_kanji(&self) -> bool {
        crate::is_kanji::contains_kanji(self)
    }

    #[inline]
    #[cfg(feature = "enable_regex")]
    fn is_japanese_with_whitelist(self, allowed: Option<&Regex>) -> bool {
        crate::is_japanese::is_japanese_with_whitelist(self, allowed)
    }

    #[inline]
    fn is_japanese(&self) -> bool {
        crate::is_japanese::is_japanese(self)
    }

    #[inline]
    fn is_romaji(&self) -> bool {
        crate::is_romaji::is_romaji(self)
    }

    #[cfg(feature = "enable_regex")]
    #[inline]
    fn is_romaji_with_whitelist(&self, allowed: Option<&Regex>) -> bool {
        crate::is_romaji::is_romaji_with_whitelist(self, allowed)
    }

    #[inline]
    fn is_mixed(&self) -> bool {
        crate::is_mixed::is_mixed(self)
    }

    #[inline]
    fn is_mixed_pass_kanji(&self, pass_kanji: bool) -> bool {
        crate::is_mixed::is_mixed_pass_kanji(self, pass_kanji)
    }
}

/// The `wana_kana::IsJapaneseChar` trait is implemented for the `char`type,
/// which allows easy checking of whether a `char` or `&str` is a Japanese character,
/// number or punctuation.
pub trait IsJapaneseChar {
    /// Tests a character. Returns true if the character is [Hiragana](https://en.wikipedia.org/wiki/Hiragana).
    fn is_hiragana(&self) -> bool;
    /// Tests a character. Returns true if the character is [Katakana](https://en.wikipedia.org/wiki/Katakana).
    fn is_katakana(&self) -> bool;
    /// Tests a character. Returns true if the character is [Hiragana](https://en.wikipedia.org/wiki/Hiragana) or [Katakana](https://en.wikipedia.org/wiki/Katakana).
    fn is_kana(&self) -> bool;
    /// Tests a character. Returns true if the character is a CJK ideograph (kanji).
    fn is_kanji(&self) -> bool;
    /// Checks if a char is in any of the japanese unicode ranges.
    fn is_japanese(&self) -> bool;
    /// Tests a character. Returns true if the character is considered a Zenkaku number(Ôºê-Ôºô)
    fn is_japanese_number(&self) -> bool;
    /// Tests a character. Returns true if the character is considered japanese punctuation.
    fn is_japanese_punctuation(&self) -> bool;
}

impl IsJapaneseChar for char {
    #[inline]
    fn is_hiragana(&self) -> bool {
        crate::utils::is_char_hiragana(*self)
    }

    #[inline]
    fn is_katakana(&self) -> bool {
        crate::utils::is_char_katakana(*self)
    }

    #[inline]
    fn is_kana(&self) -> bool {
        crate::utils::is_char_kana(*self)
    }

    #[inline]
    fn is_kanji(&self) -> bool {
        crate::utils::is_char_kanji(*self)
    }

    #[inline]
    fn is_japanese(&self) -> bool {
        crate::utils::is_char_japanese(*self)
    }

    #[inline]
    fn is_japanese_number(&self) -> bool {
        crate::utils::is_char_japanese_number(*self)
    }

    #[inline]
    fn is_japanese_punctuation(&self) -> bool {
        crate::utils::is_char_japanese_punctuation(*self)
    }
}
